"""Manages signature to recognize memory block from external process"""
from eudplib import *

# _signature is random-generated byte sequence with length 160
_signature = bytes([
    193, 250, 85, 96, 95, 202, 56, 94, 145, 228, 56, 67,
    8, 100, 106, 28, 96, 127, 190, 62, 186, 146, 132, 178,
    63, 45, 239, 182, 28, 238, 41, 164, 86, 71, 16, 251,
    123, 215, 182, 75, 92, 246, 174, 79, 228, 165, 193,
    209, 150, 25, 20, 75, 180, 123, 83, 126, 57, 232, 48,
    90, 89, 31, 7, 93, 7, 3, 26, 196, 255, 9, 228, 163,
    165, 153, 217, 129, 67, 234, 85, 33, 195, 245, 64,
    134, 13, 8, 238, 184, 71, 12, 60, 144, 176, 81, 68,
    239, 225, 45, 205, 148, 140, 1, 236, 132, 174, 43,
    98, 3, 179, 137, 192, 40, 48, 109, 14, 216, 244, 228,
    6, 21, 37, 177, 116, 15, 68, 39, 161, 110, 254, 31, 35,
    164, 205, 123, 167, 132, 103, 219, 165, 119, 154, 129,
    192, 18, 235, 192, 84, 162, 55, 30, 156, 198, 100, 36,
    100, 226, 51, 63, 113, 226
])

dead_signature = b'\x00\x00\x00\x00' + _signature[4:]

def restore_signature(sign):
	DoActions(SetMemory(sign, SetTo, b2i4(_signature, 0)))
